# PoC仕様書：AITL構造を用いた多変数ロボット制御システム

---

## 1. 目的

- AITLの三層モデル（推論層・制御層・物理層）を実際に動作させる  
- 多変数H∞制御によるロボットのロバスト制御を実現  
- FSMによる状態遷移で制御系切替と異常対応を検証  
- LLMによる推論層支援の効果を評価

---

## 2. 対象システム概要

- 多関節ロボットアーム＋冷却ファン（温度制御）  
- 制御対象：関節位置・速度、温度  
- センサ：エンコーダ、温度センサ、負荷センサ  
- アクチュエータ：DCモータ（PWM制御）、ファン（PWM制御）

---

## 3. システム構成

| 層      | 内容                                   | 開発ツール例           |
|---------|--------------------------------------|------------------------|
| 物理層  | センサ信号取得、PWM生成、アクチュエータ駆動 | Verilog HDL、C言語     |
| 制御層  | H∞制御、PID制御、FSMモード管理          | MATLAB/Simulink、C言語 |
| 推論層  | 状態遷移管理、LLMによる異常検知・支援    | Python、軽量LLM API    |

---

## 4. 主要機能

- センサデータ取得とフィルタリング  
- 多変数H∞制御実装  
- FSMによる制御モード管理（正常、異常、セーフティ）  
- LLMによる状態遷移設計支援  
- PWM信号生成と駆動制御  
- 外乱・故障シナリオ検証

---

## 5. 仕様詳細

### 5.1 センサ仕様

| センサ種別     | 仕様                   |
|----------------|------------------------|
| 温度センサ     | 精度±0.5℃、更新周期100ms |
| 角度エンコーダ | 分解能0.01度、更新周期1ms |
| 負荷センサ     | トルク0〜10Nm、更新周期1ms|

### 5.2 制御仕様

| 項目           | 内容                       |
|----------------|----------------------------|
| 制御周期       | 1ms                        |
| H∞制御         | マルチ入力マルチ出力対応   |
| PID制御        | チューニング済み           |
| 制御入力範囲   | PWMデューティ比0〜100%     |

### 5.3 推論仕様

| 項目             | 内容                        |
|------------------|-----------------------------|
| FSM状態数       | 5〜10                       |
| LLM推論応答時間 | 500ms以内（非リアルタイム） |
| 入力データ形式   | センサログCSV、状態遷移履歴JSON |
| 出力内容         | 状態遷移条件案、異常パターン提案 |

### 5.4 アクチュエータ仕様

| 項目         | 内容                |
|--------------|---------------------|
| PWM周波数    | 20kHz               |
| 駆動電圧     | 24〜48V             |
| 使用トランジスタ | 0.35μm LDMOS       |
| 保護機能     | 過電流・短絡・温度保護 |

---

## 6. 開発環境

| ツール               | 用途                    |
|----------------------|-------------------------|
| MATLAB/Simulink      | 制御設計・シミュレーション |
| C/C++コンパイラ      | 制御層・物理層実装       |
| Python（LLM API）    | 推論層実装              |
| FPGA開発環境         | HLS・Verilog実装       |
| Git/GitHub           | ソース・ドキュメント管理 |

---

## 7. テスト計画

### 7.1 単体テスト

- センサ入力検証  
- H∞制御性能評価  
- FSM状態遷移検証  
- LLM推論機能検証

### 7.2 統合テスト

- システム全体連携動作確認  
- 外乱・故障シナリオによる制御応答検証  
- FSMによる異常時切替検証

### 7.3 評価項目

- 制御精度  
- ロバスト性  
- 状態遷移応答速度  
- LLM支援効果

---

## 8. スケジュール（例）

| 期間    | 作業内容                 |
|---------|--------------------------|
| 1週目   | 要件定義・仕様決定       |
| 2〜3週目| 制御モデル作成           |
| 4週目   | FSM設計・推論層開発     |
| 5週目   | 実装・統合試験           |
| 6週目   | 故障注入テスト・評価     |

---

## 9. 役割分担（例）

| 役割       | 担当内容                     |
|------------|------------------------------|
| 制御設計   | H∞制御、Simulinkモデル作成   |
| 推論層開発 | FSM設計、LLM連携             |
| ソフト実装 | Cコード実装、物理層IF        |
| ハード設計 | FPGA、PWM、ADC設計           |
| テスト     | 単体・統合・故障テスト       |

---

*作成者：三溝 真一*  
*最終更新：2025年7月1日*  
