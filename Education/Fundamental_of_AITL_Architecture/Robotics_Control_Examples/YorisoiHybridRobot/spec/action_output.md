# 出力動作仕様（action_output.json）

---

## 📄 ファイル名

`action_output.json`

---

## 📥 形式と内容

FSMによって決定された状態に基づいて、ロボットが実行すべきアクションを定義します。

```json
{
  "timestamp": "2025-07-02T15:31:00+09:00",
  "current_state": "SAFE",
  "action_type": "voice",
  "action_content": "大丈夫ですか？何かお手伝いしましょうか？",
  "priority": 2
}
```

## 📝 各フィールド説明

| フィールド名       | 型      | 必須 | 説明                                                                 |
|--------------------|---------|------|----------------------------------------------------------------------|
| `timestamp`        | string  | 必須 | アクションが生成された日時（ISO 8601形式）。ログ同期などに使用。    |
| `current_state`    | string  | 必須 | 現在のFSM状態。`SAFE`, `ALERT`, `EMERGENCY` などと一致する必要あり。 |
| `action_type`      | string  | 必須 | 出力動作のカテゴリ：`voice`, `motion`, `led`, `sound` など。        |
| `action_content`   | string  | 必須 | 実行内容。例：TTSメッセージ／動作名／LEDカラー名／サウンド名。     |
| `priority`         | int     | 任意 | 優先度（小さいほど高優先）。省略時はデフォルト2とみなす。          |

---

## 💡 `action_type`別 `action_content` の意味

| action_type | 解釈例                                            |
|-------------|--------------------------------------------------|
| `voice`     | 音声合成エンジンに送るテキスト（例：「大丈夫ですか？」） |
| `motion`    | サーボ制御用の動作名またはプリセットID              |
| `led`       | 色名（例：`blue`, `red`）やパターン（例：`blink`）    |
| `sound`     | サウンドファイル名または警告音のID                   |

---

## 🧪 優先度活用例

- `priority = 1` → 緊急停止、即座に現在動作を中断して実行  
- `priority = 2` → 通常動作（話しかけ、LED点灯など）  
- `priority = 3` → 状態表示、ログ記録のみの通知用アクション

---

## 📎 備考

- この仕様は `fsm_engine.py` によって生成され、`actuator_driver` へ連携されます  
- 複数アクションを並列発行する場合は、`priority` に基づいて制御順序を調整します
