# 05_SecureCommModule - 仕様書 v0.1

## 1. モジュール概要

SecureCommModuleは、Standardモデルにおける基本的な無線通信機能（Wi-Fi）と簡易セキュア通信を提供するモジュールです。  
TLS対応の軽量通信スタックを搭載し、IoT用途での安全なデータ送信・受信を可能とします。

---

## 2. 主な機能

- IEEE 802.11b/g/n 準拠のWi-Fi通信機能（2.4GHz帯）
- TLS（Transport Layer Security）対応による暗号通信
- 軽量プロトコル：MQTT, HTTPS, WebSocket（設定切替可）
- 証明書ベースの認証方式（Pre-shared key / X.509）
- 再接続／リトライ機能、通信ログ出力対応

---

## 3. 入出力インターフェース

| 種類         | 信号名        | 説明                                |
|--------------|---------------|-------------------------------------|
| 通信制御     | UART_TX/RX    | 通信スタックとのコマンド送受信         |
| 通信制御     | I2C_SCL/SDA   | アドレス制御および通信状態取得（オプション）|
| ネット接続   | WIFI_ANT      | 外部アンテナ接続（PCBアンテナも可）     |
| ステータス出力| NET_STATUS     | 接続状態通知（接続／切断／通信中）      |

---

## 4. 通信仕様

| 項目                | 値                                   |
|---------------------|--------------------------------------|
| 通信方式            | Wi-Fi（802.11b/g/n）                 |
| 周波数帯域          | 2.4GHz                               |
| 暗号方式            | AES-128, TLS1.2                      |
| 認証方式            | PSK, X.509証明書                     |
| サーバプロトコル     | MQTT v3.1.1, HTTP/1.1, WebSocket     |
| 通信速度（理論値）   | 最大 72.2 Mbps（20MHz帯域時）        |
| 消費電力（通信中）   | 約 150〜250mW                        |
| 消費電力（待機時）   | 10〜15mW                             |

---

## 5. 構成図（概念）

```
       +------------------------+
       | SecureCommModule       |
       +------------------------+
         ▲       ▲       ▲
         │       │       │
    UART/I2C   WIFI_ANT  NET_STATUS
         │
    通信スタック（TLS/MQTT）
         │
      [AI制御 / 外部センサー連携]
```

---

## 6. 実装メモ

- UART通信速度：最大 115.2 kbps（標準は 9.6〜38.4 kbps）
- ESP32-C3、WROOM-02などのSoCモジュールをベースに検討
- TLS処理はモジュール内で完結（ホスト側負荷軽減）

---

## 7. 検討課題

- 通信エラー発生時の再試行ロジック最適化
- TLS証明書の安全な書き込み／更新手順
- 外部NVM（不揮発メモリ）への鍵格納対応

---

## 8. 関連資料

- [Wi-Fi通信SoC一覧.xlsx]
- [MQTT通信プロトコル図解.pdf]
- [TLSハンドシェイク処理手順.md]
