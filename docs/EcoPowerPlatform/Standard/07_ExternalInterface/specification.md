# 07_ExternalInterface - 仕様書 v0.1

## 1. モジュール概要

ExternalInterfaceモジュールは、Standardモデルと外部機器（PC、センサ、拡張基板等）との接続・通信を担うインタフェースブロックです。  
学習用途や実験向けに柔軟で扱いやすい物理I/Oおよび論理インタフェースを提供し、汎用性の高い接続性を確保します。

---

## 2. 主な機能

- USBインタフェース（デバイス/ホスト）
- UART, I2C, SPIなどの汎用通信I/Fをサポート
- GPIOによる外部制御信号の送受信
- ユーザー定義ピン割当（ジャンパ設定／ソフト切替）
- 外部拡張用ヘッダ（標準2.54mmピッチ）

---

## 3. インタフェース一覧

| インタフェース種別 | 信号名         | 機能／用途                          |
|--------------------|----------------|-------------------------------------|
| USB                | USB_DP/DN/VBUS | 給電兼デバイス通信／PC接続           |
| UART               | TXD / RXD      | シリアル通信（ログ・設定）           |
| I2C                | SCL / SDA      | センサや他ICとの通信                 |
| SPI                | CLK / MISO / MOSI / CS | 高速双方向通信                     |
| GPIO               | GPIO0〜7       | 入出力切替可能な汎用I/O              |
| 外部拡張           | EXT_HDR_10P    | 外部基板接続用ヘッダ（VCC/GND含む）   |

---

## 4. 電気的仕様

| 項目               | 値                                |
|--------------------|-----------------------------------|
| I/O電圧レベル       | 3.3V ロジック（5Vトレラント）       |
| GPIO最大電流       | ±8mA / ピン                        |
| USB仕様           | USB 2.0 Full Speed（12 Mbps）      |
| ピン間絶縁耐圧      | 30V（外部ESD対策回路あり）          |

---

## 5. 接続構成図（例）

```
     +------------------------+
     | ExternalInterfaceUnit  |
     +------------------------+
         │    │    │     │
         ▼    ▼    ▼     ▼
       USB  UART  GPIO  I2C/SPI
         │    │           │
         ▼    ▼           ▼
      [PC] [Display]   [Sensor Board]
```

---

## 6. 実装メモ

- USB機能はCDCクラス準拠の仮想COMポートとして実装
- EXT_HDRはユニバーサルピン配置（互換モジュールあり）
- GPIOはプルアップ/ダウン切替可能（ソフト設定）

---

## 7. 検討課題

- USB-PD対応の導入可否（給電切替統合）
- UART/I2Cの同時利用時のバス競合制御
- GPIOピンのソフトウェア割込み対応（イベントトリガ）

---

## 8. 関連資料

- [外部I/F回路図_v1.0.pdf]
- [USB通信仕様書（CDCクラス）.md]
- [EXTヘッダーピン配置一覧.xlsx]
