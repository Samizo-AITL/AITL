# 環境・土壌センサモジュール 設計仕様書  
**Sky-HyEV AgriEdge Model v1.0**

---

## 1. 概要

本モジュールは、Sky-HyEV AgriEdgeにおいてAI制御ブロックへ入力されるセンサ情報を統合的に収集・補正・送信する役割を担う。温湿度、土壌水分、光量、CO₂などの複数センサを統合し、AITLの意思決定に必要な環境状態を定量的に把握する。

---

## 2. センサ構成

| センサ種別      | 測定対象        | 備考                        |
|-----------------|-----------------|-----------------------------|
| 温度センサ       | 気温／地温      | I²C温度IC or サーミスタ     |
| 湿度センサ       | 相対湿度        | 高精度デジタルRHセンサ      |
| 土壌水分センサ   | 水分量          | 抵抗式 or 静電容量式（ADC） |
| 光センサ         | 日射量          | フォトダイオード＋アンプ     |
| CO₂センサ        | 二酸化炭素濃度  | UART/I²C対応                |
| pHセンサ（任意）| 土壌酸性度      | 将来的に追加可能            |

---

## 3. 回路構成と信号処理

- **マイコン系ADC処理**
  - アナログ式センサ（pH/水分）はADCで読取り（10〜12bit）
  - 校正機構付き（ゼロ点・スパン校正）

- **デジタルセンサ I/F**
  - I²Cバス：温湿度、CO₂、光量（複数共存）
  - UART：CO₂または将来拡張用
  - SPI：未使用（予備）

---

## 4. データ出力形式

| 項目       | 単位 | 精度   | 更新周期 |
|------------|------|--------|----------|
| 温度       | ℃    | ±0.5℃ | 1秒毎     |
| 湿度       | %RH  | ±2%    | 1秒毎     |
| 土壌水分   | %    | ±5%    | 5秒毎     |
| 光量       | lux  | ±10%   | 1秒毎     |
| CO₂濃度    | ppm  | ±50ppm | 10秒毎    |

- 出力フォーマット（JSON形式例）：
```json
{
  "temp": 25.2,
  "humid": 64,
  "soil": 42,
  "light": 1534,
  "co2": 413
}

---

## 5. AITLとの接続

- センサ信号は `PreProcessor` にて時系列同期および正規化処理（min-maxスケーリング、ノイズ除去など）を受けたのち、AITLロジックに供給される。
- AITLでは各センサ値を条件判定の引数とし、状況依存ルールのトリガーとして使用する。

### AITLルール例（センサベース）
	•	本モジュールの出力は、AITL判断ブロックの**「条件部（IF）」に相当**
	•	例：

IF 土壌水分 < 30% AND 光量 > 2000lux THEN 灌水実行
---

## 6. モジュール仕様

| 項目              | 仕様内容                                  |
|-------------------|-------------------------------------------|
| 動作電圧          | 3.3V / 5V（EcoAgriPowerより供給）          |
| 通信I/F           | I²C（標準）／UART（拡張用）                |
| アナログ入力      | 最大4ch（ADC 10bit／12bit, 内蔵 or 外付） |
| デジタルセンサ数  | I²C最大4デバイス接続可                    |
| 消費電力          | 30〜80mW（常時計測＋送信）                 |
| 防水・保護等級    | IP65相当（屋外利用対応）                   |
| 校正方法          | 基本：ファクトリー校正、応用：現地ゼロスパン調整対応 |
| 動作温度範囲      | -10〜60℃（農業利用想定）                  |

---

## 7. 教育・評価モード（PoCDK連携）

- **PoCDK GUI表示機能**：
  - 各センサのリアルタイム値をグラフ／ログ形式で表示
  - 異常値（欠損／スパイク／センサエラー）を自動検出

- **学習向け機能**：
  - 仮想センサモード（値をGUIから注入）
  - AITLルール切替による判断挙動の変化確認

---

## 8. 関連モジュールとの接続

- `01_AIControlImage/`：判断ロジック（センサ→推論）
- `02_CMOSCamera/`：画像との相関分析（マルチモーダル）
- `05_PowerControl/`：センサ稼働に必要な給電制御
- `07_EduInterface/`：PoCDK環境での評価GUIとの連携

---

## 9. 補足・備考

- 商用展開時には、センサ信号の無線化（LoRa/BLE）も対応可能
- AITLにおけるルールエンジンとの親和性を重視し、出力形式はJSON or バイナリ選択式
- 教育環境向けには、センサ値に人工ノイズを加えた「異常データ再現モード」も提供予定

---

*Drafted: 2025-06-27*
